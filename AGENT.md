# AQW Script Debugging Agent

## Project Overview

This is a C# scripting project for AQW (AdventureQuest Worlds) automation using the Skua bot framework. Scripts automate quest completion, farming, and story progression.

## Your Role

You are an expert debugging agent for AQW bot scripts. Your job is to identify and fix issues where:

- Scripts kill the wrong monsters for quest items
- Quests don't complete properly
- Items don't drop as expected
- Story progression gets stuck

## Project Structure

### Core Files (Framework)

- **CoreBots.cs** - Core bot functionality, inventory management, combat
- **CoreStory.cs** - Story quest handling with `KillQuest`, `MapItemQuest`, etc.
- **CoreFarms.cs** - Farming utilities (gold, XP, reputation)
- **CoreAdvanced.cs** - Advanced features
- **CoreDailies.cs** - Daily quest management

‚ö†Ô∏è **IMPORTANT:**

- **z_CompiledScript.cs** - This is an AUTO-GENERATED compiled file. **DO NOT EDIT THIS FILE!**
- Always edit the source Core\*.cs files instead (CoreBots.cs, CoreStory.cs, etc.)
- If the change is necessary to the specific story only and not everything, you can change that specific file only too.
- Changes to z_CompiledScript.cs will be overwritten when the project recompiles

### Data Files

- **ids/QuestData - QuestData.csv** - Complete quest database with quest IDs, names, requirements, and rewards
- **ids/Shop ID List - [ranges].csv** - Shop ID databases organized by ID ranges (1-1000, 1001-2000, 2001-3000)

Use these CSV files to:

- Verify quest IDs and requirements
- Look up shop IDs for buyable items
- Cross-reference quest rewards and accept requirements

### Script Categories

- **Story/** - Story completion scripts organized by saga/map
- **Farm/** - Farming scripts (gold, XP, rep)
- **Dailies/** - Daily quest scripts
- **Nation/** - Nulgath/Nation farming
- **Legion/** - Legion farming
- **Good/Evil/Chaos/** - Class and item-specific scripts
- **Seasonal/** - Seasonal event scripts
- **Other/** - Miscellaneous scripts

## Common Issues & How to Fix

### Issue 1: Wrong Monster for Quest Item

**Symptom:** Script kills Monster X for Item Y, but Item Y doesn't drop.

**Diagnosis Steps:**

1. **Open `ids/QuestData - QuestData.csv`** and search for the quest ID
2. **Verify quest requirements** - Check which items are needed and their quantities
3. **Check monster names** - Note which monsters are supposed to drop the items
4. **In-game verification** (if needed): Check the quest book and quest requirements manually
5. **Fallback**: Check AQW Wiki (https://aqwwiki.wikidot.com/) if CSV data is unclear

**Fix:**

```csharp
// BEFORE (wrong monster)
Story.KillQuest(1234, "mapname", "Wrong Monster");

// AFTER (correct monster)
Story.KillQuest(1234, "mapname", "Correct Monster");
```

**For multiple items from different monsters:**

```csharp
// Make sure monster names align with quest requirement order
Story.KillQuest(1234, "mapname", new[] { "Monster1", "Monster2" });

// OR use manual approach if complex
if (!Story.QuestProgression(1234))
{
    Core.EnsureAccept(1234);
    Core.HuntMonster("mapname", "Monster1", "Item1", 5);
    Core.HuntMonster("mapname", "Monster2", "Item2", 3);
    Core.EnsureComplete(1234);
}
```

### Issue 2: Quest Not Completing After Getting Items

**Symptom:** All items collected but quest won't turn in.

**Common Causes:**

1. Quest requires kill count, not just items
2. Multiple monsters must be killed even if items drop early
3. Quest has hidden requirements (cutscenes, dialogues)

**Fix:**

```csharp
// For kill count quests, use QuestProgression wrapper
if (!Story.QuestProgression(1234))
{
    Core.EnsureAccept(1234);
    Core.HuntMonster("mapname", "Monster", "Quest Item", 5);
    Core.EnsureComplete(1234);
}

// For quests stuck on cutscenes
if (!Story.QuestProgression(1234))
{
    Core.EnsureAccept(1234);
    Core.HuntMonster("mapname", "Monster", "Item");
    Core.EnsureComplete(1234);
    Bot.Wait.ForQuestComplete(1234); // Extra wait for cutscene
}
```

### Issue 3: Map Item Not Found

**Symptom:** Script tries to get a map item but can't find it.

**Fix:**

```csharp
// Ensure correct map item ID
Story.MapItemQuest(1234, "mapname", 5678); // 5678 is the map item ID

// For multiple map items
Story.MapItemQuest(1234, "mapname", new[] { 5678, 5679, 5680 });
```

### Issue 4: Monster Name Changed/Renamed

**Symptom:** Error says "Monster not found on map"

**Fix:**

1. Join the map in-game and check the monsters present
2. Verify exact monster names (case-sensitive)
3. Update script with correct monster name

```csharp
// Old name
Story.KillQuest(1234, "mapname", "Old Monster Name");

// Updated name
Story.KillQuest(1234, "mapname", "New Monster Name");
```

### Issue 5: Quest Requires Multiple Steps

**Symptom:** Quest has both map items AND monster kills

**Fix:**

```csharp
// Combined approach
Story.MapItemQuest(1234, "mapname", 5678);
Story.KillQuest(1234, "mapname", "Monster");

// OR do it manually for full control
if (!Story.QuestProgression(1234))
{
    Core.EnsureAccept(1234);
    Core.GetMapItem(5678, 5, "mapname");
    Core.HuntMonster("mapname", "Monster", "Item", 3);
    Core.EnsureComplete(1234);
}
```

### Issue 6: Black Screen After Cutscene Skip

**Symptom:** Screen turns black after a cutscene is skipped, making the game unplayable.

**Root Cause:** When cutscenes are skipped, the game client sometimes doesn't properly refresh the display, leaving a black screen.

**Fix:**
This is **automatically handled** by the framework with a dedicated method:

```csharp
// New method that fixes black screen (called automatically)
private void FixCutsceneBlackScreen()
{
    Task.Run(async () =>
    {
        await Task.Delay(1000);           // Wait 500ms for cutscene to skip
        Bot.Options.LagKiller = true;    // Enable anti-lag
        await Task.Delay(500);           // Wait 100ms
        Bot.Options.LagKiller = false;   // Disable anti-lag
    });
}
```

**How It Works:**

1. Method waits **500ms asynchronously** (cutscenes are skipped slightly after movement)
2. Toggles `LagKiller` to force screen redraw
3. This clears any black screen from skipped cutscenes
4. Runs in background, doesn't block bot execution

**When It's Applied (Automatically):**

- ‚úÖ After **every cell jump** (`Jump` method)
- ‚úÖ After **every room change** (`PerformJump` method via `JumpWait`)
- ‚úÖ After **every map load** (`Join` method)
- ‚úÖ When **stuck in cutscene cells** (`CutSceneFixer` method)
- ‚úÖ Works for all scripts without any modifications needed

**Manual Fix (Rare Cases):**

```csharp
// Only if you encounter black screen in non-cutscene scenarios
Bot.Options.LagKiller = true;
Bot.Sleep(100);
Bot.Options.LagKiller = false;
Bot.Sleep(100);
```

**Note:** This fix is built into the core framework and runs automatically after every map load and cell change. You don't need to add any code to scripts - it just works!

## Debugging Workflow

### Step 1: Identify the Problem

1. Read the error message or user description
2. Find the quest ID in the script
3. Note the map name and monster/item mentioned

### Step 2: Verify Quest Data

**First, check the local data files:**

1. Open `ids/QuestData - QuestData.csv`
2. Search for the quest ID
3. Verify requirements and rewards

Ask yourself:

- What is the actual quest ID?
- What items does it require?
- Which monsters drop those items?
- Are there map items to collect?
- Does it require kill counts?

**Pro Tip:** The CSV files are your first stop for verification. They contain complete quest data and are faster than checking wikis or in-game.

### Step 3: Check the Code

Look for patterns:

```csharp
// Quest patterns to check
Story.KillQuest(QUESTID, "map", "monster");
Story.MapItemQuest(QUESTID, "map", itemID);
Core.HuntMonster("map", "monster", "item", quantity);
```

### Step 4: Apply the Fix

‚ö†Ô∏è **CRITICAL REMINDER:**

- **NEVER edit z_CompiledScript.cs** - it's auto-generated!
- Always edit the source files: CoreBots.cs, CoreStory.cs, or the specific Story/Farm/etc. script
- Changes to z_CompiledScript.cs will be lost on recompile

**Apply fixes to the correct files:**

- Update monster names
- Fix quest item requirements
- Add missing steps
- Handle special cases

### Step 5: Verify the Fix

- Check that monster names are correct
- Verify quest IDs match
- Ensure all quest requirements are covered
- Check for proper quest progression handling

## Key Methods Reference

### CoreStory Methods

```csharp
// Kill a monster for quest items
Story.KillQuest(questID, "mapName", "MonsterName");

// Kill multiple monsters for quest
Story.KillQuest(questID, "mapName", new[] { "Monster1", "Monster2" });

// Collect map items
Story.MapItemQuest(questID, "mapName", mapItemID);

// Multiple map items
Story.MapItemQuest(questID, "mapName", new[] { mapItemID1, mapItemID2 });

// Check if quest is done
Story.QuestProgression(questID);

// Accept and complete without farming
Story.ChainQuest(questID);
```

### CoreBots Methods

```csharp
// Hunt specific monster for item
Core.HuntMonster("mapName", "MonsterName", "ItemName", quantity);

// Kill any monster in location
Core.KillMonster("mapName", "cellName", "pad", "MonsterName", "ItemName", quantity);

// Get map item
Core.GetMapItem(itemID, quantity, "mapName");

// Accept quest
Core.EnsureAccept(questID);

// Complete quest
Core.EnsureComplete(questID);

// Check if quest is completed before
Core.isCompletedBefore(questID);

// Check inventory
Core.CheckInventory("ItemName", quantity);
Core.CheckInventory(itemID, quantity);

// Join map
Core.Join("mapname");
Core.Join("mapname", "cellName", "pad");

// Jump to cell
Core.Jump("cellName", "pad");

// Bank/unbank items
Core.ToBank("ItemName");
Core.ToBank(new[] { "Item1", "Item2" });
Core.Unbank("ItemName");

// Equip class
Core.EquipClass(ClassType.Solo);  // Solo class
Core.EquipClass(ClassType.Farm);  // Farm class
```

### CoreFarms Methods

**IMPORTANT:** Check if these methods already exist before creating new farming functions!

```csharp
// GOLD FARMING
Farm.Gold(100000000);                    // Farm gold up to 100M (default)
Farm.BattleGroundE(goldQuant);          // Fast gold farming
Farm.HonorHall(goldQuant);              // Alternative gold farming
Farm.DarkWarLegion(goldQuant);          // Legion gold farming

// EXPERIENCE / LEVELING
Farm.Experience(100);                    // Level up to 100 (default)
Farm.IcestormArena(100);                // Alternative leveling method
Farm.SevenCirclesWar(100, gold);        // Level + gold simultaneously

// REPUTATION FARMING
// There are 50+ reputation farming methods. Check CoreFarms.cs before creating new ones!
Farm.AegisREP(10);                      // Aegis reputation to rank 10
Farm.AlchemyREP(10);                    // Alchemy reputation
Farm.ArcangroveREP(10);                 // Arcangrove reputation
// ... many more REP methods exist

// SPECIAL ITEMS
Farm.BludrutBrawlBoss("Combat Trophy", 5000);  // Farm combat trophies
Farm.BattleUnderB("Bone Dust", 10000);         // Farm bone dust
```

### CoreAdvanced Methods

**IMPORTANT:** These methods handle complex operations. Use them instead of reinventing!

```csharp
// BUY ITEMS FROM SHOPS
Adv.BuyItem("mapname", shopID, "ItemName", quantity);
Adv.BuyItem("mapname", shopID, itemID, quantity);

// MERGE SHOP FARMING (Auto-farms all requirements)
Adv.StartBuyAllMerge("mapname", shopID, ingredientsAction);

// ENHANCEMENTS
Adv.EnhanceEquipped(EnhancementType.Lucky);     // Enhance all equipped items
Adv.EnhanceItem("ItemName", EnhancementType.Wizard);  // Enhance specific item

// RANK UP CLASS
Adv.RankUpClass("ClassName");                   // Rank class to max rank

// GEAR MANAGEMENT
Adv.GearStore();                                // Store current gear
Adv.GearStore(true);                           // Restore stored gear

// BOOST HUNTING (for racial/generic gear boost requirements)
Adv.BoostHuntMonster("map", "monster", "item", quantity);
```

### CoreDailies Methods

**IMPORTANT:** These handle daily quests. Don't recreate daily quest logic!

```csharp
// CHECK IF DAILY IS DONE
Daily.CheckDailyv2(questID);                   // Returns true if daily is done today

// SPECIFIC DAILIES (many more exist in CoreDailies.cs)
Daily.MineCrafting();                          // MineCrafting daily
Daily.HardCoreMetals();                        // HardCore Metals daily
Daily.Cryomancer();                           // Cryomancer daily
Daily.Pyromancer();                           // Pyromancer daily
Daily.NSoDDaily();                            // Necrotic Sword of Doom daily
Daily.WheelofDoom();                          // Wheel of Doom
```

## Important Configuration Options

Before creating workarounds, check if there's a config option:

```csharp
// In CoreFarms
Farm.doGoldBoost = true;        // Use gold boosts when farming
Farm.doClassBoost = true;       // Use class boosts when farming
Farm.doRepBoost = true;         // Use reputation boosts
Farm.doExpBoost = true;         // Use experience boosts

// In CoreBots
Core.AntiLag = true;            // Enable anti-lag features (default: true)
Core.SoloClass = "ClassName";   // Set solo class (default: Generic)
Core.FarmClass = "ClassName";   // Set farm class (default: Generic)

// In CoreDailies
Daily.SkipOnMaxStack = true;    // Skip daily if item is max stack (default: true)
```

## How Scripts Are Structured

### Proper Core Object Initialization

All scripts follow this pattern for accessing core functionality:

```csharp
public class MyScript
{
    // Core object instances (ALWAYS use this pattern!)
    private IScriptInterface Bot => IScriptInterface.Instance;
    private CoreBots Core => CoreBots.Instance;
    private CoreFarms Farm => CoreFarms.Instance;
    private CoreAdvanced Adv => CoreAdvanced.Instance;
    private CoreStory Story => CoreStory.Instance;
    private CoreDailies Daily => CoreDailies.Instance;

    // For saga-specific cores
    private CoreLegion Legion => CoreLegion.Instance;
    private CoreNation Nation => CoreNation.Instance;
    // etc.

    public void ScriptMain(IScriptInterface bot)
    {
        Core.RunCore();  // ALWAYS call this first!

        // Your script logic here
    }
}
```

### Including Required Files

At the top of every script, include the core files needed:

```csharp
/*
name: Script Name
description: What this script does
tags: relevant, tags, here
*/
//cs_include Scripts/CoreBots.cs
//cs_include Scripts/CoreStory.cs
//cs_include Scripts/CoreFarms.cs
//cs_include Scripts/CoreAdvanced.cs
```

**Rules:**

- `CoreBots.cs` is ALWAYS required
- Include only what you use (but CoreBots is always needed)
- Story scripts need `CoreStory.cs`
- Farming scripts need `CoreFarms.cs`
- Advanced features need `CoreAdvanced.cs`

## Common Patterns

### Pattern 1: Simple Kill Quest

```csharp
// Quest 1234: Kill 5 Monsters for 5 Items
Story.KillQuest(1234, "mapname", "Monster");
```

### Pattern 2: Map Item Quest

```csharp
// Quest 1234: Click 3 map items
Story.MapItemQuest(1234, "mapname", 5678, 3);
```

### Pattern 3: Combined Quest

```csharp
// Quest 1234: Get map item AND kill monsters
Story.MapItemQuest(1234, "mapname", 5678);
Story.KillQuest(1234, "mapname", "Monster");
```

### Pattern 4: Complex Multi-Step Quest

```csharp
if (!Story.QuestProgression(1234))
{
    Core.EnsureAccept(1234);

    // Step 1: Collect map items
    Core.GetMapItem(5678, 3, "mapname");

    // Step 2: Kill monsters for items
    Core.HuntMonster("mapname", "Monster1", "Item1", 5);
    Core.HuntMonster("mapname", "Monster2", "Item2", 3);

    // Step 3: Complete
    Core.EnsureComplete(1234);
}
```

### Pattern 5: Boss Quest with Special Handling

```csharp
if (!Story.QuestProgression(1234))
{
    Core.EquipClass(ClassType.Solo); // Use solo class for boss
    Core.EnsureAccept(1234);
    Core.HuntMonster("mapname", "Boss", "Boss Item");
    Core.EnsureComplete(1234);
    Bot.Wait.ForQuestComplete(1234); // Extra wait for cutscene
}
```

## Resources for Verification

### Local Data Files (IMPORTANT!)

- **ids/QuestData - QuestData.csv** - Complete quest database with all quest information
  - Quest IDs, names, descriptions
  - Quest requirements (items needed)
  - Quest rewards
  - Accept requirements
- **ids/Shop ID List - [range].csv** - Shop databases organized by ID ranges
  - Shop ID List - 1-1000.csv
  - Shop ID List - 1001-2000.csv
  - Shop ID List - 2001-3000.csv

**How to Use:**

1. Open the CSV file in Excel or a text editor
2. Search for quest ID or shop ID
3. Verify requirements, monsters, and items
4. Cross-reference with in-game data if unsure

### External Resources

- **AQW Wiki:** https://aqwwiki.wikidot.com/
- Use these for additional verification when CSV data is unclear

## Debugging and Logging Methods

### Available Logging Methods

```csharp
// Basic logging
Core.Logger("Message");                           // Log message
Core.Logger("Message", "MethodName");            // Log with method name

// Debug logging (only shows if debug mode enabled)
Core.DebugLogger(this, "Debug message");

// Stop bot with message
Core.Logger("Error occurred", stopBot: true);

// Message box
Bot.ShowMessageBox("Message", "Title");
Bot.ShowMessageBox("Message", "Title", true);    // With Yes/No buttons
```

### Checking Bot State

```csharp
// Check if bot should stop
if (Bot.ShouldExit)
    return;

// Check player state
Bot.Player.Alive              // Is player alive?
Bot.Player.InCombat          // Is player in combat?
Bot.Player.Loaded            // Is player loaded?
Bot.Player.HasTarget         // Does player have target?
Bot.Player.Cell              // Current cell name
Bot.Player.Gold              // Current gold amount
Bot.Player.Level             // Current level

// Check map state
Bot.Map.Name                 // Current map name
Bot.Map.Loaded              // Is map loaded?

// Check quest state
Bot.Quests.IsUnlocked(questID)      // Is quest unlocked?
Bot.Quests.CanComplete(questID)     // Can quest be completed?
Bot.Quests.IsInProgress(questID)    // Is quest accepted?
```

### Common Debugging Patterns

```csharp
// Log when starting a quest
Core.Logger($"Starting quest {questID}: {questData.Name}");

// Log farming progress
Core.Logger($"Farming {itemName}: {currentQuant}/{requiredQuant}");

// Debug check for stuck quests
if (!Bot.Quests.CanComplete(questID))
{
    Core.Logger($"Quest {questID} cannot be completed. Missing items?");
    // Check what's missing
}

// Wait and log
Core.Logger("Waiting for map load...");
Bot.Wait.ForMapLoad("mapname");
Core.Logger("Map loaded successfully");
```

## Red Flags to Watch For

üö© **Monster name doesn't match map theme** - Likely wrong monster
üö© **Quest won't complete despite having items** - Missing kill count or hidden requirement
üö© **Script kills same monster twice in a row** - Possible duplicate or wrong monster
üö© **Item name in HuntMonster doesn't match quest requirement** - Will never complete
üö© **Map name misspelled** - Bot won't join map
üö© **Quest ID mismatch** - Script doing wrong quest
üö© **Trying to create function that already exists** - Check Core files first!
üö© **Not calling Core.RunCore()** - Script won't initialize properly
üö© **Missing cs_include directives** - Core files won't be accessible

## Example Fix Session

**User Reports:** "Quest 7114 in ghostnexus gets 8 kills on Abumi Guchi but doesn't hunt Infernal Knight"

**Your Process:**

1. ‚úÖ Locate the quest in the script:

   ```csharp
   Story.KillQuest(7114, "ghostnexus", new[] { "Abumi Guchi", "Infernal Knight" });
   ```

2. ‚úÖ Identify issue: Quest completes after first monster, doesn't continue to second

3. ‚úÖ Verify: Check if this is a CoreStory.cs bug or script bug

4. ‚úÖ Fix: The issue was in CoreStory.cs - the KillQuest method with arrays wasn't checking `Bot.Quests.CanComplete()` before exiting

5. ‚úÖ Solution: Updated CoreStory.cs to continue hunting until quest is completable, not just when items are collected

## Tips for Success

1. **Always verify quest data** - Don't trust the script, verify in-game or wiki
2. **Test incrementally** - Fix one quest at a time
3. **Check quest IDs carefully** - Off-by-one errors are common
4. **Monster names are case-sensitive** - "monster" ‚â† "Monster"
5. **Use QuestProgression wrapper** - Prevents re-doing completed quests
6. **Log everything** - Add `Core.Logger()` statements when debugging
7. **Check recent game updates** - AE frequently renames monsters/changes quests

## Before Creating New Functions - CHECK THESE FIRST!

‚ö†Ô∏è **CRITICAL:** Before suggesting or creating a new function, ALWAYS check if it already exists!

### Checklist Before Creating Functions

1. **Gold Farming?** ‚Üí Check `CoreFarms.cs` for existing `Farm.Gold()`, `Farm.BattleGroundE()`, etc.
2. **Experience Farming?** ‚Üí Check `CoreFarms.cs` for `Farm.Experience()`, `Farm.IcestormArena()`, etc.
3. **Reputation Farming?** ‚Üí Check `CoreFarms.cs` - there are 50+ REP methods already!
4. **Daily Quests?** ‚Üí Check `CoreDailies.cs` - most dailies already have methods
5. **Buying Items?** ‚Üí Use `Adv.BuyItem()` from `CoreAdvanced.cs`
6. **Merge Shop Farming?** ‚Üí Use `Adv.StartBuyAllMerge()` - it auto-farms ALL requirements!
7. **Enhancement?** ‚Üí Use `Adv.EnhanceItem()` or `Adv.EnhanceEquipped()`
8. **Story Quests?** ‚Üí Use `Story.KillQuest()`, `Story.MapItemQuest()`, etc.

### How to Check if Function Exists

```bash
# Search for method in core files
grep -r "public.*MethodName" Core*.cs

# Example: Check if gold farming exists
grep -r "public.*Gold" CoreFarms.cs
```

### Common Duplicate Mistakes

‚ùå **DON'T create:**

- New gold farming functions (use existing Farm.Gold methods)
- New reputation farming (50+ already exist in CoreFarms)
- New daily quest handlers (use CoreDailies methods)
- Custom merge shop loops (use Adv.StartBuyAllMerge)
- Manual enhancement loops (use Adv.EnhanceItem)

‚úÖ **DO create:**

- New story completions (in Story/ folder)
- New seasonal event scripts (in Seasonal/ folder)
- New item-specific farming (in Other/ folder)
- Scripts that combine existing core methods in new ways

## Your Debugging Checklist

When a user reports an issue:

- [ ] Identify the quest ID
- [ ] **Check `ids/QuestData - QuestData.csv` for quest requirements**
- [ ] Locate the quest in the script files (NOT z_CompiledScript.cs!)
- [ ] Verify quest requirements match CSV data
- [ ] Check monster names are correct
- [ ] Verify map name is correct
- [ ] Check if quest needs special handling (kill count, cutscene, etc.)
- [ ] Look for similar patterns in other working scripts
- [ ] **Check if needed functionality already exists in Core files**
- [ ] **Apply fix to source files (CoreBots.cs, CoreStory.cs, or specific script)**
- [ ] **NEVER edit z_CompiledScript.cs**
- [ ] Verify no linting errors
- [ ] Consider if fix applies to other quests too

## When in Doubt

If you're unsure about a fix:

1. **Check the CSV files first** - `ids/QuestData - QuestData.csv` has the authoritative quest data
2. Look for similar quests in the same file or folder
3. Check how they handle similar monsters/items
4. Use the manual `QuestProgression` approach for complex cases
5. Add defensive checks (`Bot.Wait.ForQuestComplete`, etc.)
6. Ask user to verify quest ID and requirements in-game

---

## Final Important Reminders

‚ö†Ô∏è **DO NOT EDIT:**

- **z_CompiledScript.cs** - This is auto-generated. All changes will be lost on recompile.

‚úÖ **DO EDIT:**

- **Core\*.cs files** (CoreBots.cs, CoreStory.cs, CoreFarms.cs, etc.) - For framework changes
- **Story/**, **Farm/**, **Dailies/**, etc. - For specific quest/farm scripts

üìÅ **USE THESE RESOURCES:**

- **ids/QuestData - QuestData.csv** - Your primary source for quest verification
- **ids/Shop ID List - [range].csv** - For shop and buyable item verification

üîç **BEFORE CREATING NEW FUNCTIONS:**

- **Check CoreFarms.cs** - 50+ reputation methods, gold farming, experience farming
- **Check CoreAdvanced.cs** - Buying items, merge shops, enhancements, boosts
- **Check CoreDailies.cs** - Most daily quests already have methods
- **Check CoreStory.cs** - All story quest handling methods
- **Search Core files** - Use grep to find if method exists: `grep -r "MethodName" Core*.cs`

üîß **ANTI-LAG FIX (AUTOMATIC):**

- Black screen after cutscenes is **automatically fixed** by the framework
- Dedicated `FixCutsceneBlackScreen()` method called after:
  - Every map load (`Join`)
  - Every cell jump (`Jump`)
  - Every room change (`PerformJump`)
  - Stuck in cutscene cells (`CutSceneFixer`)
- **No manual code needed** - it just works everywhere!

üìù **SCRIPT STRUCTURE:**

- **Always include** `//cs_include Scripts/CoreBots.cs` at minimum
- **Always call** `Core.RunCore()` first in `ScriptMain()`
- **Use proper initialization** pattern for Core objects (see "How Scripts Are Structured")

---

**Remember:** Your goal is to make the scripts work reliably. When in doubt:

1. Check if functionality already exists in Core files
2. Be conservative and use explicit, clear code rather than clever shortcuts
3. Verify with CSV data files before implementing fixes
4. Never edit z_CompiledScript.cs
